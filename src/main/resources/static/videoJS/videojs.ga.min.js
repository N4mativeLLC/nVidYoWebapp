/*
* videojs-ga - v0.6.1 - 2017-04-25
* Copyright (c) 2017 Michael Bensoussan
* Licensed MIT
*/
(function(){var a=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};videojs.plugin("ga",function(b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X=this;return null==b&&(b={}),j={},this.options_["data-setup"]&&(z=JSON.parse(this.options_["data-setup"]),z.ga&&(j=z.ga)),k=["loaded","percentsPlayed","secondsPlayed","start","end","seek","play","pause","resize","volumeChange","error","fullscreen","adstart","adpause","adend","adskip","adtimeout","adserror"],q=b.eventsToTrack||j.eventsToTrack||k,o=b.eventCategory||j.eventCategory||"Video",i=null!=b.autoLabel?b.autoLabel:!0,p=b.eventLabel||j.eventLabel,B=b.percentsPlayedInterval||j.percentsPlayedInterval||10,C=b.percentsPlayedMoments||j.percentsPlayedMoments||[],I=b.secondsPlayedInterval||j.secondsPlayedInterval||60,J=b.secondsPlayedMoments||j.secondsPlayedMoments||[],S=b.trackReplaySeconds,D=[],L=K=0,M=!1,m=!1,V=!1,H=0,x=void 0,T=void 0,w=void 0,b.debug=b.debug||!1,v=function(){return x=Number.isFinite(X.duration()),T=a.call(q,"secondsPlayed")>=0&&(!x||b.trackFiniteSeconds),!p&&i&&(p=X.currentSrc().split("/").slice(-1)[0].replace(/\.(\w{3,4})(\?.*)?$/i,"")),x||b.eventCategory||j.eventCategory||(o="Stream"),O()},y=function(){v(),a.call(q,"loadedmetadata")>=0&&N("loadedmetadata",!0)},Q=function(){x&&(a.call(q,"percentsPlayed")>=0&&R(),a.call(q,"seek")>=0&&U())},R=function(){var b,c,d,e,f,g,h;if(b=X.currentTime(),c=X.duration(),f=Math.round(b/c*100),e=void 0,f&&!(a.call(D,f)>=0)){for(g=0,h=C.length;h>g;g++)d=C[g],d===f&&(e=f);return!B||f%B||(e=d=f),e?(N("percent played",!0,f),D.push(f)):void 0}},U=function(){return L=K,K=u(),Math.abs(L-K)>1?(M=!0,N("seek start",!1,L),N("seek end",!1,K)):void 0},O=function(){var b;if(T&&!V)return V=!0,b=t(),w=setInterval(function(){t()>b&&(H++,(a.call(J,H)>=0||!(H%I))&&N("seconds played",!0,H))},1e3)},P=function(){return clearInterval(w),V=!1},r=function(){return O(),a.call(q,"start")>=0?N("start",!0):void 0},l=function(){m=!0,P(),S?H=0:T=!1,N("end",!0)},E=function(){var b;O(),b=u(),(b>0||a.call(q,"start")<0)&&N("play",!0,b),m&&0===b&&S&&N("start",!0),M=!1},F=function(){O(),M=!1},A=function(){var a,b;P(),a=u(),b=Math.round(this.duration()),a===b||M||N("pause",!1,a)},W=function(){var a;a=this.muted()===!0?0:this.volume(),N("volume change",!1,a)},G=function(){N("resize - "+this.width()+"*"+this.height(),!0)},n=function(){var a;a=u(),N("error",!0,a)},s=function(){var a;a=u(),("function"==typeof this.isFullscreen?this.isFullscreen():void 0)||("function"==typeof this.isFullScreen?this.isFullScreen():void 0)?N("enter fullscreen",!1,a):N("exit fullscreen",!1,a)},g=function(){return P(),a.call(q,"adstart")>=0?N("adstart",!1,u()):void 0},d=function(){return N("adpause",!1)},c=function(){return O(),N("adend",!0)},f=function(){return N("adskip",!1)},h=function(){return N("adtimeout",!0)},e=function(a){return N("adserror",!0,null!=a?a.AdError:void 0)},u=function(){return x?t():H},t=function(){return Math.round(X.currentTime())},N=function(a,c,d){var e;e={eventCategory:o,eventAction:a,nonInteraction:c},null!=p&&(e.eventLabel=p),null!=d&&(e.eventValue=d),X.trigger("gaEvent",e),b.sendGaEventDirectly&&window.ga&&ga("send","event",{eventCategory:o,eventAction:a,eventLabel:p,eventValue:d,nonInteraction:c}),b.debug&&console.log(e)},this.ready(function(){return this.on("loadedmetadata",y),this.on("timeupdate",Q),this.one("firstplay",r),a.call(q,"end")>=0&&this.on("ended",l),a.call(q,"play")>=0&&this.on("play",E),this.on("playing",F),a.call(q,"pause")>=0&&this.on("pause",A),a.call(q,"volumeChange")>=0&&this.on("volumechange",W),a.call(q,"resize")>=0&&this.on("resize",G),a.call(q,"error")>=0&&this.on("error",n),a.call(q,"fullscreen")>=0&&this.on("fullscreenchange",s),a.call(q,"adstart")>=0&&this.on("adstart",g),a.call(q,"adpause")>=0&&this.on("adpause",d),a.call(q,"adend")>=0&&this.on("adend",c),a.call(q,"adskip")>=0&&this.on("adskip",f),a.call(q,"adtimeout")>=0&&this.on("adtimeout",h),a.call(q,"adserror")>=0?this.on("adserror",e):void 0}),{sendbeacon:N}})}).call(this);